# Отчет по моделированию

## Ключевая метрика
Для оценки качества моделей был выбран показатель **ROC AUC Score**, поскольку эта метрика показывает качество обученной модели без привязки к конкретному порогу и позволяет корректно сравнивать модели между собой.

## 1. Подготовка данных
**Файл:** `notebooks/1. Data_preparation.ipynb`

**Выполненные действия:**
- Разбиение выборки на **TRAIN**, **TEST** и **OOT** (Out-of-Time).
- Соотношение значений целевой переменной во всех выборках оказалось примерно одинаковым.
- Проведен первичный отбор валидных признаков на основе анализа:
    - Разницы между 1-м и 99-м перцентилями.
    - Значения **PSI** (Population Stability Index).

## 2. Базовое моделирование
**Файл:** `notebooks/3. Model.ipynb`

### 2.1. Логистическая регрессия
Обучена модель **логистической регрессии с L1-регуляризацией** на всех отобранных признаках.

**Результаты:**

| sample_type | roc_auc |
|-------------|---------|
| TRAIN       | 83.0%   |
| TEST        | 82.8%   |
| OOT         | 81.1%   |

**Вывод:** Качество модели достаточно высокое, с небольшим снижением качества на тестовой и отложенной выборках.

### 2.2. Модель CatBoost (базовая)
Обучена модель **CatBoost** на том же наборе признаков.

**Результаты:**

| sample_type | roc_auc |
|-------------|---------|
| TRAIN       | 91.7%   |
| TEST        | 90.9%   |
| OOT         | 88.5%   |

**Вывод:** Качество модели CatBoost превзошло логистическую регрессию на всех выборках. Качество не сильно снижается на тестовой и отложенной выборках.

## 3. Подбор гиперпараметров CatBoost
Для модели CatBoost с помощью библиотеки **Optuna** был выполнен подбор гиперпараметров.

**Настраиваемые параметры:**
- Количество деревьев
- Глубина деревьев
- Скорость обучения (learning rate)
- Доля признаков, выбираемых случайно на каждом уровне дерева

**Результаты после подбора:**

| sample_type | roc_auc |
|-------------|---------|
| TRAIN       | 91.1%   |
| TEST        | 90.5%   |
| OOT         | 88.3%   |

**Вывод:** В результате подбора гиперпараметров не удалось добиться улучшения** качества модели по сравнению с базовой версией CatBoost.
